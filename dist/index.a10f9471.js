function e(e){return e&&e.__esModule?e.default:e}function t(e,t,s,n){let i;s=s||0;let a=(n=n||t.length-1)<=2147483647;for(;n-s>1;)i=a?s+n>>1:r((s+n)/2),t[i]<e?s=i:n=i;return e-t[s]<=t[n]-e?s:n}function s(e,t,s,n){const a=t-e,o=u(a||i(t)||1),l=r(o),c=h(10,l)*s,d=0==a?c:0;let p=y(function(e,t){return r(e/t)*t}(e-d,c)),g=y(v(t+d,c));return n&&(0==a?t>0?(p=0,g=2*t):t<0&&(g=0,p=2*e):(g-t<c&&(g+=c),e-p<c&&(p-=c),e>=0&&p<0&&(p=0),t<=0&&g>0&&(g=0))),[p,g]}const n=Math,i=n.abs,r=n.floor,a=n.round,o=n.ceil,l=n.min,c=n.max,h=n.pow,u=n.log10,d=n.PI,p=1/0;function g(e,t){return a(e/t)*t}function f(e,t,s){return l(c(e,t),s)}function m(e){return"function"==typeof e?e:()=>e}function v(e,t){return o(e/t)*t}function _(e){return a(1e3*e)/1e3}function y(e){return a(1e6*e)/1e6}const b=Array.isArray;function S(e){return"object"==typeof e&&null!==e}function w(e){let t;if(b(e))t=e.map(w);else if(S(e))for(var s in t={},e)t[s]=w(e[s]);else t=e;return t}function x(e){let t=arguments;for(let s=1;s<t.length;s++){let n=t[s];for(let t in n)S(e[t])?x(e[t],w(n[t])):e[t]=w(n[t])}return e}const k=requestAnimationFrame,I=document,D=window,M=devicePixelRatio;function E(e,t){null!=t&&e.classList.add(t)}function C(e,t,s){e.style[t]=s+"px"}function R(e,t,s,n){let i=I.createElement(e);return null!=t&&E(i,t),null!=s&&s.insertBefore(i,n),i}function T(e,t){return R("div",e,t)}function P(e,t,s){e.style.transform="translate("+t+"px,"+s+"px)"}const $={passive:!0};function B(e,t,s){t.addEventListener(e,s,$)}function F(e,t,s){t.removeEventListener(e,s,$)}const L=["January","February","March","April","May","June","July","August","September","October","November","December"],O=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function A(e){return e.slice(0,3)}const V=O.map(A),z=L.map(A),H={MMMM:L,MMM:z,WWWW:O,WWW:V};function G(e){return(e<10?"0":"")+e}const W={YYYY:e=>e.getFullYear(),YY:e=>(e.getFullYear()+"").slice(2),MMMM:(e,t)=>t.MMMM[e.getMonth()],MMM:(e,t)=>t.MMM[e.getMonth()],MM:e=>G(e.getMonth()+1),M:e=>e.getMonth()+1,DD:e=>G(e.getDate()),D:e=>e.getDate(),WWWW:(e,t)=>t.WWWW[e.getDay()],WWW:(e,t)=>t.WWW[e.getDay()],HH:e=>G(e.getHours()),H:e=>e.getHours(),h:e=>{let t=e.getHours();return 0==t?12:t>12?t-12:t},AA:e=>e.getHours()>=12?"PM":"AM",aa:e=>e.getHours()>=12?"pm":"am",a:e=>e.getHours()>=12?"p":"a",mm:e=>G(e.getMinutes()),m:e=>e.getMinutes(),ss:e=>G(e.getSeconds()),s:e=>e.getSeconds(),fff:e=>{return((t=e.getMilliseconds())<10?"00":t<100?"0":"")+t;var t}};function Y(e,t){t=t||H;let s,n=[],i=/\{([a-z]+)\}|[^{]+/gi;for(;s=i.exec(e);)n.push("{"==s[0][0]?W[s[1]]:s[0]);return e=>{let s="";for(let i=0;i<n.length;i++)s+="string"==typeof n[i]?n[i]:n[i](e,t);return s}}function q(e,t,s){let n=[];for(let r=e;r<t;r++)for(let e=0;e<s.length;e++){let t=s[e]*h(10,r);n.push(+t.toFixed(i(r)))}return n}const j=[1,2,5],N=q(-12,0,j),U=q(0,12,j),J=N.concat(U);const Z=[5e-4].concat(q(-3,0,j),[1,5,10,15,30,60,300,600,900,1800,3600,7200,10800,14400,21600,28800,43200,86400,172800,259200,345600,432e3,518400,604800,691200,777600,864e3,1296e3,2592e3,5184e3,7776e3,10368e3,15552e3,31536e3,63072e3,15768e4,31536e4,7884e5,15768e5,31536e5]);function X(e,t){return e.map((e=>[e[0],t(e[1]),e[2],t(e[4]?e[1]+e[3]:e[3])]))}const K=[[31536e3,"{YYYY}",7,"",1],[2419200,"{MMM}",7,"\n{YYYY}",1],[86400,"{M}/{D}",7,"\n{YYYY}",1],[3600,"{h}{aa}",4,"\n{M}/{D}",1],[60,"{h}:{mm}{aa}",4,"\n{M}/{D}",1],[1,":{ss}",2,"\n{M}/{D} {h}:{mm}{aa}",1],[.001,":{ss}.{fff}",2,"\n{M}/{D} {h}:{mm}{aa}",1]];function Q(e,t){return(s,n,i,r)=>{let a=t.find((e=>r>=e[0]))||t[t.length-1],o=null,l=null,c=null;return n.map(((t,s)=>{let n=e(t),i=n.getFullYear(),r=n.getDate(),h=n.getMinutes(),u=i!=o,d=r!=l,p=h!=c,g=7==a[2]&&u||4==a[2]&&d||2==a[2]&&p?a[3]:a[1];return o=i,l=r,c=h,g(n)}))}}function ee(e,t,s){return new Date(e,t,s)}function te(e,t){return t(e)}function se(e,t){return(s,n)=>t(e(n))}const ne={show:!0,x:!0,y:!0,lock:!1,points:{show:function(e,t){let s=e.series[t],n=T();n.style.background=s.stroke||"#000";let i=fe(s.width,1),r=(i-1)/-2;return C(n,"width",i),C(n,"height",i),C(n,"marginLeft",r),C(n,"marginTop",r),n}},drag:{setScale:!0,x:!0,y:!1,dist:0,uni:null,_x:!1,_y:!1},focus:{prox:-1},locked:!1,left:-10,top:-10,idx:null},ie={show:!0,stroke:"rgba(0,0,0,0.07)",width:2},re=x({},ie,{size:10}),ae='12px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',oe="bold "+ae,le={type:"x",show:!0,scale:"x",space:50,gap:5,size:50,labelSize:30,labelFont:oe,side:2,grid:ie,ticks:re,font:ae,rotate:0},ce={show:!0,scale:"x",min:p,max:-p,idxs:[]};let he=new Intl.NumberFormat(navigator.language);function ue(e,t,s,n){return t.map(he.format)}function de(e,t,s,n,i,r){let a=[];for(let e=t=r?t:+v(t,n).toFixed(12);e<=s;e=+(e+n).toFixed(12))a.push(e);return a}function pe(e,t){return t}const ge={type:"y",show:!0,scale:"y",space:40,gap:5,size:50,labelSize:30,labelFont:oe,side:3,grid:ie,ticks:re,font:ae,rotate:0};function fe(e,t){return _((3+2*(e||1))*t)}const me={scale:"y",show:!0,band:!1,spanGaps:!1,alpha:1,points:{show:function(e,t){const s=fe(e.series[t].width,M);let n=e.bbox.width/s/2,i=e.series[0].idxs;return i[1]-i[0]<=n}},values:null,min:p,max:-p,idxs:[],path:null,clip:null},ve={time:!0,auto:!1,distr:1,min:null,max:null},_e=x({},ve,{time:!1,auto:!0}),ye={};function be(e){let t=[];return{sub:function(e){t.push(e)},unsub:function(e){t=t.filter((t=>t!=e))},pub:function(e,s,n,i,r,a,o){t.length>1&&t.forEach((t=>{t!=s&&t.pub(e,s,n,i,r,a,o)}))}}}function Se(e,t,s,n){return(n?[e[0],e[1]].concat(e.slice(2)):[e[0]].concat(e.slice(1))).map(((e,n)=>we(e,n,t,s)))}function we(e,t,s,n){return x({},0==t||e&&e.side%2==0?s:n,e)}function xe(e,t,s,n){return n+(1-(e-t.min)/(t.max-t.min))*s}function ke(e,t,s,n){return n+(e-t.min)/(t.max-t.min)*s}function Ie(e,t,s){return[t,s>t?s:s+86400]}function De(e,t,s){const n=s-t;if(0==n){const e=u(n||i(s)||1),a=r(e)+1;return[t,v(s,h(10,a))]}return[t,s]}function Me(e,t,n){return s(t,n,.2,!0)}function Ee(e){return 0==e.button}function Ce(e){let t;return[e=e.replace(/\d+/,(e=>t=a(e*M))),t]}function Re(e,s,n){const o={},h=o.root=T("uplot");if(null!=e.id&&(h.id=e.id),E(h,e.class),e.title){T("title",h).textContent=e.title}const u=R("canvas"),S=o.ctx=u.getContext("2d"),$=T("wrap",h),L=T("under",$);$.appendChild(u);const O=T("over",$);((e=w(e)).plugins||[]).forEach((t=>{t.opts&&(e=t.opts(o,e)||e)}));let A=!1;const V=o.series=Se(e.series||[],ce,me,!1),z=o.axes=Se(e.axes||[],le,ge,!0),H=o.scales=x({},{x:ve,y:_e},e.scales),G=x({x:a(ge.size/2),y:a(le.size/3)},e.gutters),W=e.tzDate||(e=>new Date(1e3*e)),q=e.fmtDate||Y,j=(N=W,(e,t,s,n,i)=>{let a=[],o=n>=2592e3&&n<31536e3,l=N(t),c=l/1e3,h=ee(l.getFullYear(),l.getMonth(),o?1:l.getDate()),u=h/1e3;if(o){let e=n/2592e3,t=c==u?c:ee(h.getFullYear(),h.getMonth()+e,1)/1e3,i=new Date(1e3*t),r=i.getFullYear(),o=i.getMonth();for(let n=0;t<=s;n++){let i=ee(r,o+e*n,1),l=i-N(i/1e3);t=(+i+l)/1e3,t<=s&&a.push(t)}}else{let e=n>=86400?86400:n,o=u+(r(t)-r(c))+v(c-u,e);a.push(o);let l=N(o),h=l.getHours()+l.getMinutes()/60+l.getSeconds()/3600,d=n/3600;for(;;){o=_(o+n);let e=r(y(h+d))%24,t=N(o).getHours()-e;if(t>1&&(t=-1),o-=3600*t,o>s)break;h=(h+d)%24,_((o-a[a.length-1])/n)*i>=.7&&a.push(o)}}return a});var N;const ie=Q(W,X(K,q)),re=se(W,te("{YYYY}-{MM}-{DD} {h}:{mm}{aa}",q)),ae={};for(let e in H){let t=H[e];null==t.min&&null==t.max||(ae[e]={min:t.min,max:t.max})}const oe=x({show:!0},e.legend).show;let he,Re,Te=[],Pe=!1;if(oe){he=R("table","legend",h);const e=V[1]?V[1].values:null;if(Pe=null!=e,Pe){let t=R("tr","labels",he);for(var $e in R("th",null,t),Re=e(o,1,0),Re)R("th",null,t).textContent=$e}else Re={_:0},E(he,"inline")}const Be=o.cursor=x({},ne,e.cursor);Be.points.show=m(Be.points.show);const Fe=o.focus=x({},e.focus||{alpha:.3},Be.focus),Le=Fe.prox>=0;let Oe=[null];function Ae(e,t){const s=e.scale,n=H[s]=x({},0==t?ve:_e,H[s]);let i=n.time;n.range=m(n.range||(i?Ie:0==t?De:Me));let r=e.value;if(e.value=i?"string"==typeof r?se(W,te(r,q)):r||re:r||pe,e.label=e.label||(i?"Time":"Value"),t>0){e.width=null==e.width?1:e.width,e.paths=e.paths||vt;let t=fe(e.width,1);e.points=x({},{size:t,width:c(1,.2*t)},e.points),e.points.show=m(e.points.show),e._paths=null}if(oe&&Te.splice(t,0,function(e,t){if(0==t&&Pe)return null;let s=[],n=R("tr","series",he,he.childNodes[t]);E(n,e.class),e.show||E(n,"off");let i=R("th",null,n),r=T("ident",i);e.width&&(r.style.borderColor=e.stroke),r.style.backgroundColor=e.fill;let a=T("text",i);for(var o in a.textContent=e.label,t>0&&(B("click",i,(t=>{Be.locked||Ee(t)&&Pt(V.indexOf(e),{show:!e.show},is.setSeries)})),Le&&B("mouseenter",i,(t=>{Be.locked||Pt(V.indexOf(e),{focus:!0},is.setSeries)}))),Re){let e=R("td",null,n);e.textContent="--",s.push(e)}return s}(e,t)),Be.show){let s=function(e,t){if(t>0){let s=Be.points.show(o,t);if(s)return E(s,"cursor-pt"),E(s,e.class),P(s,-10,-10),O.insertBefore(s,Oe[t]),s}}(e,t);s&&Oe.splice(t,0,s)}}o.addSeries=function(e,t){e=we(e,t=null==t?V.length:t,ce,me),V.splice(t,0,e),Ae(V[t],t)},o.delSeries=function(e){V.splice(e,1),oe&&Te.splice(e,1)[0][0].parentNode.remove(),Oe.length>1&&Oe.splice(e,1)[0].remove()},V.forEach(Ae);for(let e in H){let t=H[e];null!=t.from&&(H[e]=x({},H[t.from],t))}const Ve=V[0].scale,ze=H[Ve].distr;let He;z.forEach((function(e,t){if(e.show){let t=e.side%2,s=H[e.scale];null==s&&(e.scale=t?V[1].scale:Ve,s=H[e.scale]);let n=s.time;e.space=m(e.space),e.rotate=m(e.rotate),e.incrs=m(e.incrs||(2==s.distr?U:n?Z:J)),e.split=m(e.split||(n&&1==s.distr?j:de));let i=e.values;e.values=n?b(i)?Q(W,X(i,q)):i||ie:i||ue,e.font=Ce(e.font),e.labelFont=Ce(e.labelFont)}}));let Ge=null,We=null;const Ye=V[0].idxs;let qe,je,Ne,Ue,Je,Ze,Xe,Ke,Qe,et,tt=null;function st(e,t){(e=e||[])[0]=e[0]||[],o.data=e,s=e.slice(),tt=s[0],He=tt.length,2==ze&&(s[0]=tt.map(((e,t)=>t))),bt(),ns("setData"),!1!==t&&nt()}function nt(){Ge=Ye[0]=0,We=Ye[1]=He-1;let e=2==ze?Ge:s[0][Ge],t=2==ze?We:s[0][We];Tt(Ve,e,t)}function it(e,t,s,n){S.strokeStyle=e||"#000",S.lineWidth=t,S.lineJoin="round",S.setLineDash(s||[]),S.fillStyle=n||"#000"}function rt(e,t){o.width=qe=Ne=e,o.height=je=Ue=t,Je=Ze=0,function(){let e=!1,t=!1,s=!1,n=!1;z.forEach(((i,r)=>{if(i.show){let{side:r,size:a}=i,o=r%2,l=a+(i.labelSize=null!=i.label?i.labelSize||30:0);l>0&&(o?(Ne-=l,3==r?(Je+=l,n=!0):s=!0):(Ue-=l,0==r?(Ze+=l,e=!0):t=!0))}})),(e||t)&&(s||(Ne-=G.x),n||(Ne-=G.x,Je+=G.x));(n||s)&&(t||(Ue-=G.y),e||(Ue-=G.y,Ze+=G.y))}(),function(){let e=Je+Ne,t=Ze+Ue,s=Je,n=Ze;function i(i,r){switch(i){case 1:return e+=r,e-r;case 2:return t+=r,t-r;case 3:return s-=r,s+r;case 0:return n-=r,n+r}}z.forEach(((e,t)=>{let s=e.side;e._pos=i(s,e.size),null!=e.label&&(e._lpos=i(s,e.labelSize))}))}();let s=o.bbox;Xe=s.left=g(Je*M,.5),Ke=s.top=g(Ze*M,.5),Qe=s.width=g(Ne*M,.5),et=s.height=g(Ue*M,.5),C(L,"left",Je),C(L,"top",Ze),C(L,"width",Ne),C(L,"height",Ue),C(O,"left",Je),C(O,"top",Ze),C(O,"width",Ne),C(O,"height",Ue),C($,"width",qe),C($,"height",je),u.width=a(qe*M),u.height=a(je*M),jt(),A&&Tt(Ve,H[Ve].min,H[Ve].max),A&&ns("setSize")}function at(){if(At)zt=!0;else{if(He>0){let e=w(H);for(let t in e){let s=e[t],n=ae[t];null!=n?(x(s,n),t==Ve&&bt()):t!=Ve&&(s.min=p,s.max=-p)}V.forEach(((n,i)=>{let r=n.scale,a=e[r];if(0==i){let e=a.range(o,a.min,a.max);a.min=e[0],a.max=e[1],Ge=t(a.min,s[0]),We=t(a.max,s[0]),s[0][Ge]<a.min&&Ge++,s[0][We]>a.max&&We--,n.min=tt[Ge],n.max=tt[We]}else if(n.show&&null==ae[r]){let e=n.min==p?a.auto?function(e,t,s){let n=p,i=-p;for(let r=t;r<=s;r++)null!=e[r]&&(n=l(n,e[r]),i=c(i,e[r]));return[n,i]}(s[i],Ge,We):[0,100]:[n.min,n.max];a.min=l(a.min,n.min=e[0]),a.max=c(a.max,n.max=e[1])}n.idxs[0]=Ge,n.idxs[1]=We}));for(let t in e){let s=e[t];if(null==s.from&&s.min!=p&&null==ae[t]){let e=s.range(o,s.min,s.max);s.min=e[0],s.max=e[1]}}for(let t in e){let s=e[t];if(null!=s.from){let t=e[s.from];if(t.min!=p){let e=s.range(o,t.min,t.max);s.min=e[0],s.max=e[1]}}}let n={};for(let t in e){let s=e[t],i=H[t];i.min==s.min&&i.max==s.max||(i.min=s.min,i.max=s.max,n[t]=!0)}V.forEach((e=>{n[e.scale]&&(e._paths=null)}));for(let e in n)ns("setScale",e)}for(let e in ae)ae[e]=null;Be.show&&Yt()}}o.setData=st,o.bbox={},o.setSize=function({width:e,height:t}){rt(e,t)};let ot,lt,ct,ht,ut,dt,pt,gt=1;function ft(){V.forEach(((e,t)=>{if(t>0&&e.show&&He>0&&null==e._paths){let n=function(e){let t=f(Ge-1,0,He-1),s=f(We+1,0,He-1);for(;null==e[t]&&t>0;)t--;for(;null==e[s]&&s<He-1;)s++;return[t,s]}(s[t]);e._paths=e.paths(o,t,n[0],n[1])}})),V.forEach(((e,t)=>{t>0&&e.show&&(e._paths&&function(e){const t=V[e];if(1==gt){const{stroke:e,fill:s,clip:n}=t._paths,i=_(t.width*M),r=i%2/2;it(t.stroke,i,t.dash,t.fill),S.globalAlpha=t.alpha,S.translate(r,r),S.save();let a=Xe,o=Ke,l=Qe,c=et,h=i*M/2;0==t.min&&(c+=h),0==t.max&&(o-=h,c+=h),S.beginPath(),S.rect(a,o,l,c),S.clip(),null!=n&&S.clip(n),t.band?(S.fill(e),i&&S.stroke(e)):(i&&S.stroke(e),null!=t.fill&&S.fill(s)),S.restore(),S.translate(-r,-r),S.globalAlpha=1}t.band&&(gt*=-1)}(t),e.points.show(o,t,Ge,We)&&function(e){let t=V[e],n=t.points;const i=_(n.width*M),r=i%2/2,o=n.width>0;let l=(n.size-n.width)/2*M,c=_(2*l);S.translate(r,r),S.save(),S.beginPath(),S.rect(Xe-c,Ke-c,Qe+2*c,et+2*c),S.clip(),S.globalAlpha=t.alpha;const h=new Path2D;for(let n=Ge;n<=We;n++)if(null!=s[e][n]){let i=a(ke(s[0][n],H[Ve],Qe,Xe)),r=a(xe(s[e][n],H[t.scale],et,Ke));h.moveTo(i+l,r),h.arc(i,r,l,0,2*d)}it(n.stroke||t.stroke||"#000",i,null,n.fill||(o?"#fff":t.stroke||"#000")),S.fill(h),o&&S.stroke(h),S.globalAlpha=1,S.restore(),S.translate(-r,-r)}(t),ns("drawSeries",t))}))}function mt(e,t,s){let n=e[e.length-1];n&&n[0]==t?n[1]=s:e.push([t,s])}function vt(e,t,n,i){const r=V[t],o=s[0],h=s[t],u=H[Ve],d=H[r.scale],g=1==gt?{stroke:new Path2D,fill:null,clip:null}:V[t-1]._paths,f=g.stroke,m=_(r.width*M);let v,y,b=p,S=-p,w=[],x=a(ke(o[1==gt?n:i],u,Qe,Xe));r.band&&1==gt&&n==Ge&&(m&&f.lineTo(-m,a(xe(h[n],d,et,Ke))),u.min<o[0]&&w.push([Xe,x-1]));for(let e=1==gt?n:i;e>=n&&e<=i;e+=gt){let t=a(ke(o[e],u,Qe,Xe));if(t==x)null!=h[e]&&(v=a(xe(h[e],d,et,Ke)),b=l(v,b),S=c(v,S));else{let s=!1;b!=p?(f.lineTo(x,b),f.lineTo(x,S),f.lineTo(x,v),y=x):s=!0,null!=h[e]?(v=a(xe(h[e],d,et,Ke)),f.lineTo(t,v),b=S=v,t-x>1&&null==h[e-1]&&(s=!0)):(b=p,S=-p),s&&mt(w,y,t),x=t}}if(null==h[i]&&mt(w,y,x),r.band){let e,t,s=100*m;-1==gt&&n==Ge&&(t=Xe-s,e=n),1==gt&&i==We&&(t=Xe+Qe+s,e=i,u.max>o[He-1]&&w.push([x,Xe+Qe])),f.lineTo(t,a(xe(h[e],d,et,Ke)))}if(1==gt&&(g.clip=function(e,t,s,n){let i=V[e],r=null;if(t.length>0){if(i.spanGaps){let e=t[0],i=t[t.length-1];t=[],s&&t.push(e),n&&t.push(i)}r=new Path2D;let e=Xe;for(let s=0;s<t.length;s++){let n=t[s];r.rect(e,Ke,n[0]-e,Ke+et),e=n[1]}r.rect(e,Ke,Xe+Qe-e,Ke+et)}return r}(t,w,null==h[n],null==h[i]),null!=r.fill)){let e=g.fill=new Path2D(f),t=a(xe(0,d,et,Ke));e.lineTo(Xe+Qe,t),e.lineTo(Xe,t)}return r.band&&(gt*=-1),g}function _t(e,t,s,n){let i;if(n<=0)i=[0,0];else{let r=e.space(o,t,s,n);i=function(e,t,s,n){let i=s/e;for(var r=0;r<t.length;r++){let e=t[r]*i;if(e>=n)return[t[r],e]}}(s-t,e.incrs(o,t,s,n,r),n,r),i.push(i[1]/r)}return i}function yt(e,t,s,n,i,r,a,o){let l=r%2/2;S.translate(l,l),it(a,r,o),S.beginPath();let c,h,u,d,p=n+(0==s||3==s?-i:i);0==t?(h=n,d=p):(c=n,u=p),e.forEach(((e,s)=>{0==t?c=u=e:h=d=e,S.moveTo(c,h),S.lineTo(u,d)})),S.stroke(),S.translate(-l,-l)}function bt(){V.forEach(((e,t)=>{t>0&&(e.min=p,e.max=-p,e._paths=null)}))}function St(){At?Vt=!0:(S.clearRect(0,0,u.width,u.height),ns("drawClear"),z.forEach(((e,t)=>{if(!e.show)return;let s=H[e.scale];if(s.min==p)return;let n=e.side,i=n%2,{min:r,max:l}=s,[c,h,u]=_t(e,r,l,0==i?Ne:Ue),g=2==s.distr,f=e.split(o,r,l,c,u,g),m=0==i?ke:xe,v=0==i?Qe:et,y=0==i?Xe:Ke,b=f.map((e=>a(m(e,s,v,y)))),w=a(e.gap*M),x=e.ticks,k=x.show?a(x.size*M):0,I=e.values(o,2==s.distr?f.map((e=>tt[e])):f,h,2==s.distr?tt[f[1]]-tt[f[0]]:c),D=2==n?e.rotate(o,I,h)*-d/180:0,E=a(e._pos*M),C=E+(k+w)*(0==i&&0==n||1==i&&3==n?-1:1),R=0==i?C:0,T=1==i?C:0;S.font=e.font[0],S.fillStyle=e.stroke||"#000",S.textAlign=D>0?"left":D<0?"right":0==i?"center":3==n?"right":"left",S.textBaseline=D||1==i?"middle":2==n?"top":"bottom";let P=1.5*e.font[1];if(I.forEach(((e,t)=>{0==i?T=b[t]:R=b[t],(""+e).split(/\n/gm).forEach(((e,t)=>{D?(S.save(),S.translate(T,R+t*P),S.rotate(D),S.fillText(e,0,0),S.restore()):S.fillText(e,T,R+t*P)}))})),e.label){S.save();let t=a(e._lpos*M);1==i?(T=R=0,S.translate(t,a(Ke+et/2)),S.rotate((3==n?-d:d)/2)):(T=a(Xe+Qe/2),R=t),S.font=e.labelFont[0],S.textAlign="center",S.textBaseline=2==n?"top":"bottom",S.fillText(e.label,T,R),S.restore()}x.show&&yt(b,i,n,E,k,_(x.width*M),x.stroke);let $=e.grid;$.show&&yt(b,i,0==i?2:1,0==i?Ke:Xe,0==i?et:Qe,_($.width*M),$.stroke,$.dash)})),ns("drawAxes"),ft(),ot=!0,ns("draw"))}function wt(e,n){let i=H[e];if(null==i.from){if(e==Ve&&(2==i.distr&&(n.min=t(n.min,s[0]),n.max=t(n.max,s[0])),i.time&&z[0].show&&n.max>n.min)){if(_t(z[0],n.min,n.max,Ne)[0]<.001)return}ae[e]=n,ot=!1,at(),!ot&&St(),ot=!1}}o.redraw=e=>{!1!==e?Tt(Ve,H[Ve].min,H[Ve].max):St()},o.setScale=wt;let xt=!1;const kt=Be.drag;let It=kt.x,Dt=kt.y;if(Be.show){let e="cursor-";Be.x&&(dt=Be.left,lt=T(e+"x",O)),Be.y&&(pt=Be.top,ct=T(e+"y",O))}const Mt=o.select=x({show:!0,left:0,width:0,top:0,height:0},e.select),Et=Mt.show?T("select",O):null;function Ct(e,t){if(Mt.show){for(let t in e)C(Et,t,Mt[t]=e[t]);!1!==t&&ns("setSelect")}}function Rt(e,t){let s=V[e],n=oe?Te[e][0].parentNode:null;var i;s.show?n&&(i="off",n.classList.remove(i)):(n&&E(n,"off"),Oe.length>1&&P(Oe[e],0,-10))}function Tt(e,t,s){wt(e,{min:t,max:s})}function Pt(e,t,s){let n=V[e];if(null!=t.focus&&function(e){e!=Ft&&(V.forEach(((t,s)=>{!function(e,t){let s=V[e];if($t(e,t),s.band){$t(V[e+1].band?e+1:e-1,t)}}(s,null==e||0==s||s==e?1:Fe.alpha)})),Ft=e,St())}(e),null!=t.show){if(n.show=t.show,Rt(e,t.show),n.band){let s=V[e+1]&&V[e+1].band?e+1:e-1;V[s].show=n.show,Rt(s,t.show)}Tt(Ve,H[Ve].min,H[Ve].max)}ns("setSeries",e,t),s&&as.pub("setSeries",o,e,t)}function $t(e,t){V[e].alpha=t,Te&&(Te[e][0].parentNode.style.opacity=t)}o.setSelect=Ct,o.setSeries=Pt;const Bt=Array(V.length);let Ft=null;function Lt(e,t){let s=Ne;t!=Ve&&(s=Ue,e=s-e);let n=e/s,i=H[t],r=i.max-i.min;return i.min+n*r}function Ot(e){return t(Lt(e,Ve),s[0],Ge,We)}oe&&Le&&B("mouseleave",he,(e=>{Be.locked||(Pt(null,{focus:!1},is.setSeries),Yt())})),o.valToIdx=e=>t(e,s[0]),o.posToIdx=Ot,o.posToVal=Lt,o.valToPos=(e,t,s)=>t==Ve?ke(e,H[t],s?Qe:Ne,s?Xe:0):xe(e,H[t],s?et:Ue,s?Ke:0);let At=!1,Vt=!1,zt=!1,Ht=!1;function Gt(e){At=!0,e(o),At=!1,zt&&at(),Ht&&Yt(),Vt&&!ot&&St(),zt=Ht=Vt=ot=At}o.batch=Gt,o.setCursor=e=>{dt=e.left,pt=e.top,Yt()};let Wt=0;function Yt(e,t){if(At)return void(Ht=!0);let n;if(Wt=0,Be.show&&(Be.x&&P(lt,a(dt),0),Be.y&&P(ct,0,a(pt))),dt<0||0==He||Ge>We){n=null;for(let e=0;e<V.length;e++)if(e>0&&(Bt[e]=p,Oe.length>1&&P(Oe[e],-10,-10)),oe){if(0==e&&Pe)continue;for(let t=0;t<Te[e].length;t++)Te[e][t].firstChild.nodeValue="--"}Le&&Pt(null,{focus:!0},is.setSeries)}else{n=Ot(dt);let e=H[Ve],t=_(ke(s[0][n],e,Ne,0));for(let e=0;e<V.length;e++){let r=V[e];if(e>0&&r.show){let a=s[e][n],o=null==a?-10:_(xe(a,H[r.scale],Ue,0));Bt[e]=o>0?i(o-pt):p,Oe.length>1&&P(Oe[e],t,o)}else Bt[e]=p;if(oe){if(n==Be.idx||0==e&&Pe)continue;let t=0==e&&2==ze?tt:s[e],i=Pe?r.values(o,e,n):{_:r.value(o,t[n],e,n)},a=0;for(let t in i)Te[e][a++].firstChild.nodeValue=i[t]}}}if(Mt.show&&xt){let e=i(dt-ht),s=i(pt-ut);if(null!=t){let[e,s]=is.scales,n=t.cursor.drag;if(It=n._x,Dt=n._y,e){let n=H[e],r=t.posToVal(t.select.left,e),a=t.posToVal(t.select.left+t.select.width,e);Mt.left=ke(r,n,Ne,0),Mt.width=i(Mt.left-ke(a,n,Ne,0)),C(Et,"left",Mt.left),C(Et,"width",Mt.width),s||(C(Et,"top",Mt.top=0),C(Et,"height",Mt.height=Ue))}if(s){let n=H[s],r=t.posToVal(t.select.top,s),a=t.posToVal(t.select.top+t.select.height,s);Mt.top=xe(r,n,Ue,0),Mt.height=i(Mt.top-xe(a,n,Ue,0)),C(Et,"top",Mt.top),C(Et,"height",Mt.height),e||(C(Et,"left",Mt.left=0),C(Et,"width",Mt.width=Ne))}}else{It=kt.x&&e>=kt.dist,Dt=kt.y&&s>=kt.dist;let t=kt.uni;if(null!=t?It&&Dt&&(It=e>=t,Dt=s>=t,It||Dt||(s>e?Dt=!0:It=!0)):kt.x&&kt.y&&(It||Dt)&&(It=Dt=!0),It){let t=l(ht,dt);C(Et,"left",Mt.left=t),C(Et,"width",Mt.width=e),Dt||(C(Et,"top",Mt.top=0),C(Et,"height",Mt.height=Ue))}if(Dt){let e=l(ut,pt);C(Et,"top",Mt.top=e),C(Et,"height",Mt.height=s),It||(C(Et,"left",Mt.left=0),C(Et,"width",Mt.width=Ne))}It||Dt||(C(Et,"height",Mt.height=0),C(Et,"width",Mt.width=0))}}if(Be.idx=n,Be.left=dt,Be.top=pt,kt._x=It,kt._y=Dt,null!=e&&(as.pub("mousemove",o,dt,pt,Ne,Ue,n),Le)){let e=l.apply(null,Bt),t=null;e<=Fe.prox&&Bt.some(((s,n)=>{if(s==e)return t=n})),Pt(t,{focus:!0},is.setSeries)}A&&ns("setCursor")}let qt=null;function jt(){qt=O.getBoundingClientRect()}function Nt(e,t,s,n,i,r,a){Be.locked||(Ut(e,t,s,n,i,r,a,!1,null!=e),null!=e?0==Wt&&(Wt=k(Yt)):Yt(null,t))}function Ut(e,t,s,n,i,r,a,o,l){if(null!=e)s=e.clientX-qt.left,n=e.clientY-qt.top;else{if(s<0||n<0)return dt=-10,void(pt=-10);let[e,a]=is.scales;s=null!=e?ke(t.posToVal(s,e),H[e],Ne,0):Ne*(s/i),n=null!=a?xe(t.posToVal(n,a),H[a],Ue,0):Ue*(n/r)}l&&((s<=1||s>=Ne-1)&&(s=g(s,Ne)),(n<=1||n>=Ue-1)&&(n=g(n,Ue))),o?(ht=s,ut=n):(dt=s,pt=n)}function Jt(){Ct({width:0,height:0},!1)}function Zt(e,t,s,n,i,r,a){(null!=t||Ee(e))&&(xt=!0,It=Dt=kt._x=kt._y=!1,Ut(e,t,s,n,i,r,0,!0,!1),null!=e&&(B("mouseup",I,Xt),as.pub("mousedown",o,ht,ut,Ne,Ue,null)))}function Xt(e,t,s,n,i,r,a){if(null!=t||Ee(e)){xt=kt._x=kt._y=!1,Ut(e,t,s,n,i,r,0,!1,!0);let a=Mt.width>0||Mt.height>0;a&&Ct(Mt),kt.setScale&&a?(Gt((()=>{if(It&&Tt(Ve,Lt(Mt.left,Ve),Lt(Mt.left+Mt.width,Ve)),Dt)for(let e in H){let t=H[e];e!=Ve&&null==t.from&&Tt(e,Lt(Mt.top+Mt.height,e),Lt(Mt.top,e))}})),Jt()):Be.lock&&(Be.locked=!Be.locked,Be.locked||Yt())}null!=e&&(F("mouseup",I,Xt),as.pub("mouseup",o,dt,pt,Ne,Ue,null))}function Kt(e,t,s,n,i,r,a){if(!Be.locked){let e=xt;if(xt){let e=!0,t=!0,s=10;if(It&&Dt&&(e=dt<=s||dt>=Ne-s,t=pt<=s||pt>=Ue-s),It&&e){let e=dt,t=Ne-dt,s=l(e,t);s==e&&(dt=0),s==t&&(dt=Ne)}if(Dt&&t){let e=pt,t=Ue-pt,s=l(e,t);s==e&&(pt=0),s==t&&(pt=Ue)}Yt(1),xt=!1}dt=-10,pt=-10,Yt(1),e&&(xt=e)}}function Qt(e,t,s,n,i,r,a){nt(),Jt(),null!=e&&as.pub("dblclick",o,dt,pt,Ne,Ue,null)}const es={};let ts;es.mousedown=Zt,es.mousemove=Nt,es.mouseup=Xt,es.dblclick=Qt,es.setSeries=(e,t,s,n)=>{Pt(s,n)},Be.show&&(B("mousedown",O,Zt),B("mousemove",O,Nt),B("mouseenter",O,jt),B("mouseleave",O,(e=>{k(Kt)})),B("dblclick",O,Qt),ts=function(e,t){let s=null;function n(){s=null,e()}return function(){clearTimeout(s),s=setTimeout(n,t)}}(jt,100),B("resize",D,ts),B("scroll",D,ts),o.syncRect=jt);const ss=o.hooks=e.hooks||{};function ns(e,t,s){e in ss&&ss[e].forEach((e=>{e.call(null,o,t,s)}))}(e.plugins||[]).forEach((e=>{for(let t in e.hooks)ss[t]=(ss[t]||[]).concat(e.hooks[t])}));const is=x({key:null,setSeries:!1,scales:[Ve,null]},Be.sync),rs=is.key,as=null!=rs?ye[rs]=ye[rs]||be():be();function os(){rt(e.width,e.height),ns("init",e,s),st(s||e.data,!1),ae[Ve]?wt(Ve,ae[Ve]):nt(),Ct(Mt,!1),A=!0,ns("ready")}return as.sub(o),o.pub=function(e,t,s,n,i,r,a){es[e](null,t,s,n,i,r,a)},o.destroy=function(){as.unsub(o),F("resize",D,ts),F("scroll",D,ts),h.remove(),ns("destroy")},n?n instanceof HTMLElement?(n.appendChild(h),os()):n(o,os):os(),o}Re.assign=x,Re.rangeNum=s,Re.fmtDate=Y,Re.tzDate=function(e,t){let s;return"Etc/UTC"==t?s=new Date(+e+6e4*e.getTimezoneOffset()):(s=new Date(e.toLocaleString("en-US",{timeZone:t})),s.setMilliseconds(e.getMilliseconds())),s};class Te{static scale(e,t,s){const{min:n,max:i}=Te.calculateBounds(e);let r=1;for(;;){const e=Math.pow(10,r),a=n-n%e;let o=i+(i%e==0?0:e-i%e);a===o&&(o+=e);if((o-a)/e<=t||"number"==typeof s&&r===s)return{scaledMin:a,scaledMax:o,scale:e};r++}}static scaleMatrix(e,t,s){const n=Math.max(...e.flat().filter((e=>null!==e)));return Te.scale([0,Te.isFiniteOrZero(n)],t,s)}static generateTicks(e,t,s){const n=[];for(let i=e;i<=t;i+=s)n.push(i);return n}static calculateBounds(e){if(0===e.length)return{min:0,max:0};{const t=Math.min(...e.filter((e=>null!==e))),s=Math.max(...e.filter((e=>null!==e)));return{min:Te.isFiniteOrZero(t),max:Te.isFiniteOrZero(s)}}}static isFiniteOrZero(e){return Number.isFinite(e)?e:0}}class Pe{constructor(){var e,t,s;s=()=>{this._div.style.display="none"},(t="hide")in(e=this)?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,this._div=document.getElementById("tooltip")}set(e,t,s,n,i){this._div.innerHTML=i,this._div.style.display="block";const r=this._div.offsetWidth;e+s+1.2*r>window.innerWidth&&(e-=r,s*=-1),this._div.style.top=`${t+n}px`,this._div.style.left=`${e+s}px`}}class $e{constructor(){this._div=document.getElementById("status-text")}set(e){this._div.innerText=e,this._div.style.display="block"}hide(){this._div.style.display="none"}}const Be=[25565,19132];function Fe(e){const t=new Date(0);return t.setUTCSeconds(e),t.toLocaleTimeString()}function Le(e){const t=new Date(0);return t.setUTCSeconds(e),t.toLocaleDateString()}function Oe(e){return"number"!=typeof e?"-":e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function Ae(e){let t;return{hooks:{init:s=>{t=s.root.querySelector(".over"),t.onmouseenter=()=>e(),t.onmouseleave=()=>e()},setCursor:s=>{const{left:n,top:i,idx:r}=s.cursor;if(null===r)e();else{const s=t.getBoundingClientRect();e({left:s.left+n+window.pageXOffset,top:s.top+i+window.pageYOffset},r)}}}}}var Ve=null;var ze=e(function(){return Ve||(Ve=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(e)return(""+e[0]).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}()),Ve}()+"missing_favicon.8d3eece1.svg");function He(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ge{constructor(e){He(this,"getServerRegistrations",(()=>Object.values(this._registeredServers))),this._app=e,this._serverIdsByName=[],this._serverDataById=[],this._registeredServers=[]}assignServers(e){for(let t=0;t<e.length;t++){const s=e[t];this._serverIdsByName[s.name]=t,this._serverDataById[t]=s}}createServerRegistration(e){const t=this._serverDataById[e],s=new We(this._app,e,t);return this._registeredServers[e]=s,s}getServerRegistration(e){if("string"==typeof e){const t=this._serverIdsByName[e];return this._registeredServers[t]}if("number"==typeof e)return this._registeredServers[e]}reset(){this._serverIdsByName=[],this._serverDataById=[],this._registeredServers=[],document.getElementById("server-list").innerHTML=""}}class We{constructor(e,t,s){He(this,"playerCount",0),He(this,"isVisible",!0),He(this,"isFavorite",!1),He(this,"rankIndex",void 0),He(this,"lastRecordData",void 0),He(this,"lastPeakData",void 0),this._app=e,this.serverId=t,this.data=s,this._graphData=[[],[]],this._failedSequentialPings=0}getGraphDataIndex(){return this.serverId+1}addGraphPoints(e,t){this._graphData=[t.slice(),e]}buildPlotInstance(){this._plotInstance=new Re({plugins:[Ae(((e,t)=>{if(e){const s=this._graphData[1][t];"number"!=typeof s?this._app.tooltip.hide():this._app.tooltip.set(e.left,e.top,10,10,`${Oe(s)} Players<br>${Fe(this._graphData[0][t])}`)}else this._app.tooltip.hide()}))],height:100,width:400,cursor:{y:!1,drag:{setScale:!1,x:!1,y:!1},sync:{key:"minetrack-server",setSeries:!0}},series:[{},{stroke:"#E9E581",width:2,value:(e,t)=>`${Oe(t)} Players`,spanGaps:!0,points:{show:!1}}],axes:[{show:!1},{ticks:{show:!1},font:'14px "Open Sans", sans-serif',stroke:"#A3A3A3",size:55,grid:{stroke:"#333",width:1},split:()=>{const{scaledMin:e,scaledMax:t,scale:s}=Te.scale(this._graphData[1],4);return Te.generateTicks(e,t,s)}}],scales:{y:{auto:!1,range:()=>{const{scaledMin:e,scaledMax:t}=Te.scale(this._graphData[1],4);return[e,t]}}},legend:{show:!1}},this._graphData,document.getElementById(`chart_${this.serverId}`))}handlePing(e,t){"number"==typeof e.playerCount?(this.playerCount=e.playerCount,this._failedSequentialPings=0):++this._failedSequentialPings>5&&(this.playerCount=0),this._graphData[0].push(t),this._graphData[1].push(e.playerCount);for(const e of this._graphData)e.length>this._app.publicConfig.serverGraphMaxLength&&e.shift();this._plotInstance.setData(this._graphData)}updateServerRankIndex(e){this.rankIndex=e,document.getElementById(`ranking_${this.serverId}`).innerText=`#${e+1}`}_renderValue(e,t){const s=document.getElementById(`${e}_${this.serverId}`);s.style.display="block";const n=document.getElementById(`${e}-value_${this.serverId}`)||s;n&&("function"==typeof t?t(n):n.innerText=t)}_hideValue(e){document.getElementById(`${e}_${this.serverId}`).style.display="none"}updateServerStatus(e,t){if(e.versions&&this._renderValue("version",function(e,t){if(!(e&&e.length&&t&&t.length))return;let s=[];const n=[];for(let t=0;t<e.length;t++)t>0&&e[t]-e[t-1]!=1&&(n.push(s),s=[]),s.push(e[t]);return s.length>0&&n.push(s),0!==n.length?n.map((e=>{const s=t[e[0]];return 1===e.length?s:`${s}-${t[e[e.length-1]]}`})).join(", "):void 0}(e.versions,t[this.data.type])||""),e.recordData&&(this._renderValue("record",(t=>{e.recordData.timestamp>0?(t.innerText=`${Oe(e.recordData.playerCount)} (${Le(e.recordData.timestamp)})`,t.title=`At ${Le(e.recordData.timestamp)} ${Fe(e.recordData.timestamp)}`):t.innerText=Oe(e.recordData.playerCount)})),this.lastRecordData=e.recordData),e.graphPeakData&&(this._renderValue("peak",(t=>{t.innerText=Oe(e.graphPeakData.playerCount),t.title=`At ${Fe(e.graphPeakData.timestamp)}`})),this.lastPeakData=e.graphPeakData),e.error?(this._hideValue("player-count"),this._renderValue("error",e.error.message)):"number"!=typeof e.playerCount?(this._hideValue("player-count"),this._renderValue("error","Failed to ping")):"number"==typeof e.playerCount&&(this._hideValue("error"),this._renderValue("player-count",Oe(e.playerCount))),e.favicon){const t=document.getElementById(`favicon_${this.serverId}`);t.getAttribute("src")!==e.favicon&&t.setAttribute("src",e.favicon)}}initServerStatus(e){const t=document.createElement("div");var s,n;t.id=`container_${this.serverId}`,t.innerHTML=`<div class="column column-favicon">\n        <img class="server-favicon" src="${e.favicon||ze}" id="favicon_${this.serverId}" title="${this.data.name}\n${s=this.data.ip,n=this.data.port,n&&!Be.includes(n)?`${s}:${n}`:s}">\n        <span class="server-rank" id="ranking_${this.serverId}"></span>\n      </div>\n      <div class="column column-status">\n        <h3 class="server-name"><span class="${this._app.favoritesManager.getIconClass(this.isFavorite)}" id="favorite-toggle_${this.serverId}"></span> ${this.data.name}</h3>\n        <span class="server-error" id="error_${this.serverId}"></span>\n        <span class="server-label" id="player-count_${this.serverId}">Players: <span class="server-value" id="player-count-value_${this.serverId}"></span></span>\n        <span class="server-label" id="peak_${this.serverId}">${this._app.publicConfig.graphDurationLabel} Peak: <span class="server-value" id="peak-value_${this.serverId}">-</span></span>\n        <span class="server-label" id="record_${this.serverId}">Record: <span class="server-value" id="record-value_${this.serverId}">-</span></span>\n        <span class="server-label" id="version_${this.serverId}"></span>\n      </div>\n      <div class="column column-graph" id="chart_${this.serverId}"></div>`,t.setAttribute("class","server"),document.getElementById("server-list").appendChild(t)}updateHighlightedValue(e){["player-count","peak","record"].forEach((t=>{const s=document.getElementById(`${t}_${this.serverId}`),n=document.getElementById(`${t}-value_${this.serverId}`);e&&t===e?(s.setAttribute("class","server-highlighted-label"),n.setAttribute("class","server-highlighted-value")):(s.setAttribute("class","server-label"),n.setAttribute("class","server-value"))}))}initEventListeners(){document.getElementById(`favorite-toggle_${this.serverId}`).addEventListener("click",(()=>{this._app.favoritesManager.handleFavoriteButtonClick(this)}),!1)}}class Ye{constructor(e){this._app=e,this._hasRequestedHistoryGraph=!1,this._reconnectDelayBase=0}reset(){this._hasRequestedHistoryGraph=!1}createWebSocket(){let e="ws:";"https:"===location.protocol&&(e="wss:"),this._webSocket=new WebSocket(`${e}//${location.host}`),this._webSocket.onopen=()=>{this._app.caption.set("Loading..."),this._reconnectDelayBase=0},this._webSocket.onclose=e=>{this._app.handleDisconnect(),1006===e.code?this._app.caption.set("Lost connection!"):this._app.caption.set("Disconnected due to error."),this.scheduleReconnect()},this._webSocket.onmessage=e=>{const t=JSON.parse(e.data);switch(t.message){case"init":this._app.setPublicConfig(t.config),this._app.setPageReady(!0),this._app.publicConfig.isGraphVisible&&this.sendHistoryGraphRequest(),t.servers.forEach(((e,s)=>{this._app.addServer(s,e,t.timestampPoints)})),t.mojangServices&&this._app.mojangUpdater.updateStatus(t.mojangServices),this._app.handleSyncComplete();break;case"updateServers":for(let e=0;e<t.updates.length;e++){const s=this._app.serverRegistry.getServerRegistration(e),n=t.updates[e];s&&(s.handlePing(n,t.timestamp),s.updateServerStatus(n,this._app.publicConfig.minecraftVersions))}t.updateHistoryGraph&&(this._app.graphDisplayManager.addGraphPoint(t.timestamp,Object.values(t.updates).map((e=>e.playerCount))),this._app.graphDisplayManager.redraw()),this._app.percentageBar.redraw(),this._app.updateGlobalStats();break;case"updateMojangServices":this._app.mojangUpdater.updateStatus(t);break;case"historyGraph":{this._app.graphDisplayManager.buildPlotInstance(t.timestamps,t.graphData);let e=0,s="";this._app.serverRegistry.getServerRegistrations().map((e=>e.data.name)).sort().forEach((t=>{const n=this._app.serverRegistry.getServerRegistration(t);s+=`<td>\n                <input type="checkbox" class="graph-control" minetrack-server-id="${n.serverId}" ${n.isVisible?"checked":""}>\n                ${t}\n                </input></td>`,++e%6==0&&(s+="</tr><tr>")})),document.getElementById("big-graph-checkboxes").innerHTML=`<table><tr>${s}</tr></table>`,document.getElementById("big-graph-controls").style.display="block",this._app.graphDisplayManager.initEventListeners();break}}}}scheduleReconnect(){this._webSocket=void 0,this._reconnectDelayBase++,this._reconnectDelaySeconds=Math.min(this._reconnectDelayBase*this._reconnectDelayBase,30);const e=setInterval((()=>{this._reconnectDelaySeconds--,0===this._reconnectDelaySeconds?(clearInterval(e),this._app.caption.set("Reconnecting..."),this.createWebSocket()):this._reconnectDelaySeconds>0&&this._app.caption.set(`Reconnecting in ${this._reconnectDelaySeconds}s...`)}),1e3)}sendHistoryGraphRequest(){this._hasRequestedHistoryGraph||(this._hasRequestedHistoryGraph=!0,this._webSocket.send("requestHistoryGraph"))}}function qe(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const je=[{getName:()=>"Players",sortFunc:(e,t)=>t.playerCount-e.playerCount,highlightedValue:"player-count"},{getName:e=>`${e.publicConfig.graphDurationLabel} Peak`,sortFunc:(e,t)=>e.lastPeakData||t.lastPeakData?e.lastPeakData&&!t.lastPeakData?-1:t.lastPeakData&&!e.lastPeakData?1:t.lastPeakData.playerCount-e.lastPeakData.playerCount:0,testFunc:e=>{for(const t of e.serverRegistry.getServerRegistrations())if(t.lastPeakData)return!0;return!1},highlightedValue:"peak"},{getName:()=>"Record",sortFunc:(e,t)=>e.lastRecordData||t.lastRecordData?e.lastRecordData&&!t.lastRecordData?-1:t.lastRecordData&&!e.lastRecordData?1:t.lastRecordData.playerCount-e.lastRecordData.playerCount:0,testFunc:e=>{for(const t of e.serverRegistry.getServerRegistrations())if(t.lastRecordData)return!0;return!1},highlightedValue:"record"}];class Ne{constructor(e){qe(this,"handleSortByButtonClick",(()=>{for(;;){this._sortOptionIndex=(this._sortOptionIndex+1)%je.length;const e=je[this._sortOptionIndex];if(!e.testFunc||e.testFunc(this._app))break}this.updateSortOption(),this.updateLocalStorage()})),qe(this,"updateSortOption",(()=>{const e=je[this._sortOptionIndex];this._textElement.innerText=e.getName(this._app);for(const t of this._app.serverRegistry.getServerRegistrations())t.updateHighlightedValue(e.highlightedValue);this.sortServers()})),qe(this,"sortServers",(()=>{const e=je[this._sortOptionIndex],t=this._app.serverRegistry.getServerRegistrations().sort(((t,s)=>t.isFavorite&&!s.isFavorite?-1:s.isFavorite&&!t.isFavorite?1:e.sortFunc(t,s))),s=t.map((e=>e.serverId));if(this._lastSortedServers){let e=!0;for(let t=0;t<s.length;t++)if(s[t]!==this._lastSortedServers[t]){e=!1;break}if(e)return}this._lastSortedServers=s;const n=this._app.serverRegistry.getServerRegistrations().sort(e.sortFunc);t.forEach((function(e){const t=document.getElementById("server-list"),s=document.getElementById(`container_${e.serverId}`);t.appendChild(s),e.updateServerRankIndex(n.indexOf(e))}))})),this._app=e,this._buttonElement=document.getElementById("sort-by"),this._textElement=document.getElementById("sort-by-text"),this._sortOptionIndex=0}reset(){this._lastSortedServers=void 0,this._buttonElement.style.display="none",this._textElement.innerText="...",this._buttonElement.removeEventListener("click",this.handleSortByButtonClick)}loadLocalStorage(){if("undefined"!=typeof localStorage){const e=localStorage.getItem("minetrack_sort_option_index");e&&(this._sortOptionIndex=parseInt(e))}}updateLocalStorage(){"undefined"!=typeof localStorage&&(0!==this._sortOptionIndex?localStorage.setItem("minetrack_sort_option_index",this._sortOptionIndex):localStorage.removeItem("minetrack_sort_option_index"))}show(){this.loadLocalStorage(),this.updateSortOption(),this._buttonElement.addEventListener("click",this.handleSortByButtonClick),this._buttonElement.style.display="inline-block"}}class Ue{constructor(e){var t,s,n;n=e=>{e.isFavorite=!e.isFavorite,document.getElementById(`favorite-toggle_${e.serverId}`).setAttribute("class",this.getIconClass(e.isFavorite)),this._app.sortController.sortServers(),this._app.graphDisplayManager.handleServerIsFavoriteUpdate(e),this.updateLocalStorage()},(s="handleFavoriteButtonClick")in(t=this)?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,this._app=e}loadLocalStorage(){if("undefined"!=typeof localStorage){let e=localStorage.getItem("minetrack_favorite_servers");if(e){e=JSON.parse(e);for(let t=0;t<e.length;t++){const s=this._app.serverRegistry.getServerRegistration(e[t]);s&&(s.isFavorite=!0,document.getElementById(`favorite-toggle_${s.serverId}`).setAttribute("class",this.getIconClass(s.isFavorite)))}}}}updateLocalStorage(){if("undefined"!=typeof localStorage){const e=this._app.serverRegistry.getServerRegistrations().filter((e=>e.isFavorite)).map((e=>e.data.name));e.length>0?localStorage.setItem("minetrack_favorite_servers",JSON.stringify(e)):localStorage.removeItem("minetrack_favorite_servers")}}getIconClass(e){return e?"icon-star server-is-favorite":"icon-star-o server-is-not-favorite"}}function Je(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ze{constructor(e){Je(this,"redraw",(()=>{this.updateLocalStorage();for(const e of this._app.serverRegistry.getServerRegistrations())this._plotInstance.series[e.getGraphDataIndex()].show=e.isVisible;this._plotInstance.redraw()})),Je(this,"resize",(()=>{this._plotInstance.setSize(this.getPlotSize()),this._resizeRequestTimeout&&clearTimeout(this._resizeRequestTimeout),this._resizeRequestTimeout=void 0})),Je(this,"handleServerButtonClick",(e=>{const t=parseInt(e.target.getAttribute("minetrack-server-id")),s=this._app.serverRegistry.getServerRegistration(t);s.isVisible!==e.target.checked&&(s.isVisible=e.target.checked,this._showOnlyFavorites=!1,this.redraw())})),Je(this,"handleShowButtonClick",(e=>{const t=e.target.getAttribute("minetrack-show-type");this._showOnlyFavorites="favorites"===t;let s=!1;this._app.serverRegistry.getServerRegistrations().forEach((function(e){let n;"all"===t?n=!0:"none"===t?n=!1:"favorites"===t&&(n=e.isFavorite),e.isVisible!==n&&(e.isVisible=n,s=!0)})),s&&(this.redraw(),this.updateCheckboxes())})),Je(this,"handleSettingsToggle",(()=>{const e=document.getElementById("big-graph-controls-drawer");"block"!==e.style.display?e.style.display="block":e.style.display="none"})),Je(this,"handleServerIsFavoriteUpdate",(e=>{this._showOnlyFavorites&&e.isVisible!==e.isFavorite&&(e.isVisible=e.isFavorite,this.redraw(),this.updateCheckboxes())})),this._app=e,this._graphData=[],this._graphTimestamps=[],this._hasLoadedSettings=!1,this._initEventListenersOnce=!1,this._showOnlyFavorites=!1}addGraphPoint(e,t){if(!this._hasLoadedSettings)return;const s=this._plotInstance.scales.x,n=s.min>this._graphTimestamps[0]||s.max<this._graphTimestamps[this._graphTimestamps.length-1];this._graphTimestamps.push(e);for(let e=0;e<t.length;e++)this._graphData[e].push(t[e]);const i=this._app.publicConfig.graphMaxLength;this._graphTimestamps.length>i&&this._graphTimestamps.splice(0,this._graphTimestamps.length-i);for(const e of this._graphData)e.length>i&&e.splice(0,e.length-i);this._plotInstance.setData(this.getGraphData(),!n)}loadLocalStorage(){if("undefined"!=typeof localStorage){let e;if(localStorage.getItem("minetrack_show_favorites")&&(this._showOnlyFavorites=!0),e=this._showOnlyFavorites?localStorage.getItem("minetrack_favorite_servers"):localStorage.getItem("minetrack_hidden_servers"),e){e=JSON.parse(e);for(const t of this._app.serverRegistry.getServerRegistrations())this._showOnlyFavorites?t.isVisible=e.indexOf(t.data.name)>=0:t.isVisible=e.indexOf(t.data.name)<0}}}updateLocalStorage(){if("undefined"!=typeof localStorage){const e=this._app.serverRegistry.getServerRegistrations().filter((e=>!e.isVisible)).map((e=>e.data.name));e.length>0&&!this._showOnlyFavorites?localStorage.setItem("minetrack_hidden_servers",JSON.stringify(e)):localStorage.removeItem("minetrack_hidden_servers"),this._showOnlyFavorites?localStorage.setItem("minetrack_show_favorites",!0):localStorage.removeItem("minetrack_show_favorites")}}getVisibleGraphData(){return this._app.serverRegistry.getServerRegistrations().filter((e=>e.isVisible)).map((e=>this._graphData[e.serverId]))}getPlotSize(){return{width:.9*Math.max(window.innerWidth,800),height:400}}getGraphData(){return[this._graphTimestamps,...this._graphData]}getGraphDataPoint(e,t){const s=this._graphData[e];if(s&&t<s.length&&"number"==typeof s[t])return s[t]}getClosestPlotSeriesIndex(e){let t=-1,s=Number.MAX_VALUE;const n=this._plotInstance.bbox.height/devicePixelRatio;for(let i=1;i<this._plotInstance.series.length;i++){const r=this._plotInstance.series[i];if(!r.show)continue;const a=this._plotInstance.data[i][e];if("number"==typeof a){const e=this._plotInstance.scales[r.scale],o=(1-(a-e.min)/(e.max-e.min))*n,l=Math.abs(o-this._plotInstance.cursor.top);l<s&&(t=i,s=l)}}return t}buildPlotInstance(e,t){this._hasLoadedSettings||(this._hasLoadedSettings=!0,this.loadLocalStorage());for(const s of t){const t=e.length-s.length;if(t>0){const e=Array(t).fill(null);s.unshift(...e)}}this._graphTimestamps=e,this._graphData=t;const s=this._app.serverRegistry.getServerRegistrations().map((e=>({stroke:e.data.color,width:2,value:(e,t)=>`${Oe(t)} Players`,show:e.isVisible,spanGaps:!0,points:{show:!1}})));this._plotInstance=new Re({plugins:[Ae(((e,t)=>{if(e){const s=this.getClosestPlotSeriesIndex(t),n=this._app.serverRegistry.getServerRegistrations().filter((e=>e.isVisible)).sort(((e,t)=>e.isFavorite!==t.isFavorite?e.isFavorite?-1:1:e.data.name.localeCompare(t.data.name))).map((e=>{const n=this.getGraphDataPoint(e.serverId,t);let i=e.data.name;return s===e.getGraphDataIndex()&&(i=`<strong>${i}</strong>`),e.isFavorite&&(i=`<span class="${this._app.favoritesManager.getIconClass(!0)}"></span> ${i}`),`${i}: ${Oe(n)}`})).join("<br>")+`<br><br><strong>${Fe(this._graphTimestamps[t])}</strong>`;this._app.tooltip.set(e.left,e.top,10,10,n)}else this._app.tooltip.hide()}))],...this.getPlotSize(),cursor:{y:!1},series:[{},...s],axes:[{font:'14px "Open Sans", sans-serif',stroke:"#FFF",grid:{show:!1},space:60},{font:'14px "Open Sans", sans-serif',stroke:"#FFF",size:65,grid:{stroke:"#333",width:1},split:()=>{const e=this.getVisibleGraphData(),{scaledMax:t,scale:s}=Te.scaleMatrix(e,10,4);return Te.generateTicks(0,t,s)}}],scales:{y:{auto:!1,range:()=>{const e=this.getVisibleGraphData(),{scaledMin:t,scaledMax:s}=Te.scaleMatrix(e,10,4);return[t,s]}}},legend:{show:!1}},this.getGraphData(),document.getElementById("big-graph")),document.getElementById("settings-toggle").style.display="inline-block"}requestResize(){this._plotInstance&&(this._resizeRequestTimeout&&clearTimeout(this._resizeRequestTimeout),this._resizeRequestTimeout=setTimeout(this.resize,200))}initEventListeners(){this._initEventListenersOnce||(this._initEventListenersOnce=!0,document.getElementById("settings-toggle").addEventListener("click",this.handleSettingsToggle,!1),document.querySelectorAll(".graph-controls-show").forEach((e=>{e.addEventListener("click",this.handleShowButtonClick,!1)}))),document.querySelectorAll(".graph-control").forEach((e=>{e.addEventListener("click",this.handleServerButtonClick,!1)}))}updateCheckboxes(){document.querySelectorAll(".graph-control").forEach((e=>{const t=parseInt(e.getAttribute("minetrack-server-id")),s=this._app.serverRegistry.getServerRegistration(t);e.checked=s.isVisible}))}reset(){this._plotInstance&&(this._plotInstance.destroy(),this._plotInstance=void 0),this._graphTimestamps=[],this._graphData=[],this._hasLoadedSettings=!1,this._resizeRequestTimeout&&(clearTimeout(this._resizeRequestTimeout),this._resizeRequestTimeout=void 0),document.getElementById("big-graph-checkboxes").innerHTML="",document.getElementById("big-graph-controls").style.display="none",document.getElementById("settings-toggle").style.display="none"}}const Xe=["Auth","Sessions","API","Skins"];class Ke{updateStatus(e){for(const t of Xe)e[t]&&this.updateServiceStatus(t,e[t])}updateServiceStatus(e,t){document.getElementById(`mojang-status_${e}`).setAttribute("class",`header-button header-button-group mojang-status-${t.toLowerCase()}`),document.getElementById(`mojang-status-text_${e}`).innerText=t}reset(){document.querySelectorAll(".mojang-status").forEach((function(e){e.setAttribute("class","header-button header-button-group")})),document.querySelectorAll(".mojang-status-text").forEach((function(e){e.innerText="..."}))}}function Qe(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class et{constructor(e){Qe(this,"redraw",(()=>{const e=this._app.serverRegistry.getServerRegistrations().sort((function(e,t){return e.playerCount-t.playerCount})),t=this._app.getTotalPlayerCount();let s=0;for(const n of e){const e=Math.round(n.playerCount/t*this._parent.offsetWidth),i=document.getElementById(`perc-bar-part_${n.serverId}`)||this.createPart(n),r=`${e}px`,a=`${s}px`;i.style.width===r&&i.style.left===a||(i.style.width=r,i.style.left=a),s+=e}})),Qe(this,"handleMouseOver",(e=>{const t=parseInt(e.target.getAttribute("minetrack-server-id")),s=this._app.serverRegistry.getServerRegistration(t);var n,i;this._app.tooltip.set(e.target.offsetLeft,e.target.offsetTop,10,this._parent.offsetTop+this._parent.offsetHeight+10,`${void 0!==s.rankIndex?`#${s.rankIndex+1} `:""}\n      ${s.data.name}<br>\n      ${Oe(s.playerCount)} Players<br>\n      <strong>${n=s.playerCount,i=this._app.getTotalPlayerCount(),Math.round(n/i*100*10)/10+"%"}</strong>`)})),Qe(this,"handleMouseOut",(()=>{this._app.tooltip.hide()})),this._app=e,this._parent=document.getElementById("perc-bar")}createPart(e){const t=document.createElement("div");return t.id=`perc-bar-part_${e.serverId}`,t.style.background=e.data.color,t.setAttribute("class","perc-bar-part"),t.setAttribute("minetrack-server-id",e.serverId),this._parent.appendChild(t),t.addEventListener("mouseover",this.handleMouseOver,!1),t.addEventListener("mouseout",this.handleMouseOut,!1),t}reset(){this._parent.innerHTML=""}}function tt(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const st=new class{constructor(){tt(this,"publicConfig",void 0),tt(this,"addServer",((e,t,s)=>{const n=this.serverRegistry.createServerRegistration(e);n.initServerStatus(t),void 0!==t.playerCountHistory&&(n.addGraphPoints(t.playerCountHistory,s),n.playerCount=t.playerCount),n.buildPlotInstance(),n.updateServerStatus(t,this.publicConfig.minecraftVersions),n.initEventListeners()})),tt(this,"updateGlobalStats",(()=>{const e=this.getTotalPlayerCount();e!==this._lastTotalPlayerCount&&(this._lastTotalPlayerCount=e,document.getElementById("stat_totalPlayers").innerText=Oe(e));const t=this.serverRegistry.getServerRegistrations().length;t!==this._lastServerRegistrationCount&&(this._lastServerRegistrationCount=t,document.getElementById("stat_networks").innerText=t)})),this.tooltip=new Pe,this.caption=new $e,this.serverRegistry=new Ge(this),this.socketManager=new Ye(this),this.sortController=new Ne(this),this.graphDisplayManager=new Ze(this),this.mojangUpdater=new Ke,this.percentageBar=new et(this),this.favoritesManager=new Ue(this),this._taskIds=[]}init(){this.socketManager.createWebSocket()}setPageReady(e){document.getElementById("push").style.display=e?"block":"none",document.getElementById("footer").style.display=e?"block":"none",document.getElementById("status-overlay").style.display=e?"none":"block"}setPublicConfig(e){this.publicConfig=e,this.serverRegistry.assignServers(e.servers),this.initTasks()}handleSyncComplete(){this.caption.hide(),this.favoritesManager.loadLocalStorage(),this.sortController.show(),this.percentageBar.redraw(),this.updateGlobalStats()}initTasks(){this._taskIds.push(setInterval(this.sortController.sortServers,5e3))}handleDisconnect(){this.tooltip.hide(),this.serverRegistry.reset(),this.socketManager.reset(),this.sortController.reset(),this.graphDisplayManager.reset(),this.mojangUpdater.reset(),this.percentageBar.reset(),this.publicConfig=void 0,this._taskIds.forEach(clearInterval),this._taskIds=[],this._lastTotalPlayerCount=void 0,this._lastServerRegistrationCount=void 0,document.getElementById("stat_totalPlayers").innerText=0,document.getElementById("stat_networks").innerText=0,this.setPageReady(!1)}getTotalPlayerCount(){return this.serverRegistry.getServerRegistrations().map((e=>e.playerCount)).reduce(((e,t)=>e+t),0)}};document.addEventListener("DOMContentLoaded",(()=>{st.init(),window.addEventListener("resize",(function(){st.percentageBar.redraw(),st.graphDisplayManager.requestResize()}),!1)}),!1);
//# sourceMappingURL=index.a10f9471.js.map
